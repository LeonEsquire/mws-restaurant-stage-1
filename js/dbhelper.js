var _createClass=function(){function r(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,n,e){return n&&r(t.prototype,n),e&&r(t,e),t}}();function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var DBHelper=function(){function o(){_classCallCheck(this,o)}return _createClass(o,null,[{key:"fetchRestaurants",value:function(n){fetch(o.DATABASE_URL).then(function(t){if(200!==t.status)throw Error(t.status);return t.json()}).then(function(t){return n(null,t)}).catch(function(t){return n(t,null)})}},{key:"fetchRestaurantById",value:function(t,e){fetch("http://localhost:1337/restaurants/"+t).then(function(t){return t.json()}).then(function(n){fetch(o.REVIEWS_URL+t).then(function(t){return t.json()}).then(function(t){n.reviews=t,e(null,n)})}).catch(function(){return e("Restaurant does not exist",null)})}},{key:"fetchRestaurantByCuisine",value:function(r,u){o.fetchRestaurants(function(t,n){if(t)u(t,null);else{var e=n.filter(function(t){return t.cuisine_type==r});u(null,e)}})}},{key:"fetchRestaurantByNeighborhood",value:function(r,u){o.fetchRestaurants(function(t,n){if(t)u(t,null);else{var e=n.filter(function(t){return t.neighborhood==r});u(null,e)}})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(r,u,a){o.fetchRestaurants(function(t,n){if(t)a(t,null);else{var e=n;"all"!=r&&(e=e.filter(function(t){return t.cuisine_type==r})),"all"!=u&&(e=e.filter(function(t){return t.neighborhood==u})),a(null,e)}})}},{key:"fetchNeighborhoods",value:function(u){o.fetchRestaurants(function(t,e){if(t)u(t,null);else{var r=e.map(function(t,n){return e[n].neighborhood}),n=r.filter(function(t,n){return r.indexOf(t)==n});u(null,n)}})}},{key:"fetchCuisines",value:function(u){o.fetchRestaurants(function(t,e){if(t)u(t,null);else{var r=e.map(function(t,n){return e[n].cuisine_type}),n=r.filter(function(t,n){return r.indexOf(t)==n});u(null,n)}})}},{key:"urlForRestaurant",value:function(t){return"./restaurant.html?id="+t.id}},{key:"imageUrlForRestaurant",value:function(t){return"/img/"+t.photograph+".jpg"}},{key:"thumbnailImageUrlForRestaurant",value:function(t){return"/img/thumbnail/"+(t.photograph+"-thumbnail.jpg")}},{key:"lowerResolutionImage",value:function(t){return"/img/1x/"+(t.photograph+"_1x.jpg")}},{key:"mapMarkerForRestaurant",value:function(t,n){return new google.maps.Marker({position:t.latlng,title:t.name,url:o.urlForRestaurant(t),map:n,animation:google.maps.Animation.DROP})}},{key:"dbRestaurant",get:function(){return idb.open("restaurant",1,function(t){t.createObjectStore("restaurants",{keyPath:"id"})})}},{key:"DATABASE_URL",get:function(){return"http://localhost:1337/restaurants"}},{key:"REVIEWS_URL",get:function(){return"http://localhost:1337/reviews/?restaurant_id="}}]),o}();
